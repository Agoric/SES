<html>
<head>
 <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
 <title>Testing SES</title>
 <script src="../dist/ses-shim.js"></script>
 <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>

<p>In this demo, the defender (above) has a secret
"<a href="https://en.wikipedia.org/wiki/Macguffin">MacGuffin</a>", in this
case a random code which the attacker (below) is trying to guess. Everything
is running inside a single SES RootRealm. The attacker's code (pasted into
the text box) is evaluated by the defender when the Run button is
pressed.</p>

<p>To make things easier for the attacker, their code is offered a function
which interacts with the secret in a predictable way. The secret consists of
a ten-character alphanumeric code. The function takes an index (0-9) and
returns a promise. The promise fires <code>N</code> milliseconds afterwards,
with a value of <code>undefined</code>, where <code>N</code> depends upon the
secret character at that index. (The attacker doesn't get access
to <code>Date.now</code>, or any other form of non-determinism, so it should
not be able to read from this covert channel).</p>

<p>The attacker also gets access to a logging function which takes a
ten-character string (nominally a guessed code) and displays it in
a <code>&gt;div&lt;</code>. (In the future, when "Domato" is complete, the
attacker will get full access to that DIV). The attacker wins if they log a
code which matches the secret.</p>

<p>The defender is given access to two functions which the attacker does not
get: one which provides random values to create the MacGuffin (normally
forbidden since <code>Crypto.getRandomValues</code> is non-deterministic),
and a second to delay arbitrary amounts of time (normally forbidden for the
same reason). These are created in the Root realm and provided as endowments
to the defender. A normal application would need to protect these carefully,
as either would allow the defender code to reach the Root realm's
full-powered <code>Function</code> constructor, allowing it to break
confinement.</p>

<center>
<div class="outer-box">
<div class="code-box">
 <span id="macguffin">uninitialized</span>
</div>
</div>
</center>

<br>

<center>
<div class="outer-box">
<div class="code-box" id="guess-box">
 <span id="guess">uninitialized</span>
</div>
</div>
</center>

<div class="attacker-input">
<b>Attacker Code:</b>
 <textarea id="attacker-program" rows="20" cols="80" placeholder="(paste attack code here)">
setGuess('0000000000');
 </textarea>
 <button id="attacker-submit" type="button">Execute</button>
 <button id="attacker-stop" type="button">Stop</button>
</div>

<h2>Sample Attacks:</h2>

<p>Click the button to populate the test code, then use Execute to run it.</p>

<ul>
 <li><button id="sample-0" type="button">All Zeros</button></li>
 <li><button id="sample-counter" type="button">Counter</button></li>
</ul>


<script src="demo-start.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>
